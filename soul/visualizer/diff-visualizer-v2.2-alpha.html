<!-- diff-visualizer-v2.2-alpha.htmlï¼ˆresponse-logé€£æºGUIä»˜ãï¼‰é››å½¢ --><!-- çµ±åˆãƒ‘ã‚¹æƒ³å®š: soul/visualizer/diff-visualizer-v2.2-alpha.html --><!DOCTYPE html><html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Diff Visualizer v2.2-alpha</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 p-4">
  <div id="app">
    <h1 class="text-2xl font-bold mb-4">é­‚å·®åˆ†ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ v2.2-alpha</h1><!-- æ™‚ç³»åˆ—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ -->
<div class="mb-4">
  <label class="mr-2">å±¥æ­´è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰:</label>
  <select v-model="historyMode" class="border px-2 py-1 rounded">
    <option value="diff">å·®åˆ†ãƒ­ã‚°ã®ã¿</option>
    <option value="diff-response">å¿œç­”å±¥æ­´ãƒ¢ãƒ¼ãƒ‰</option>
  </select>
</div>

<!-- å·®åˆ†è¡¨ç¤ºãƒ–ãƒ­ãƒƒã‚¯ -->
<div v-for="diff in filteredDiffs" :key="diff.diff_id" class="p-4 mb-4 border rounded bg-white">
  <p class="text-sm font-semibold">ğŸ†” {{ diff.diff_id }} ï½œ ğŸ§¬ {{ diff.source_lre_persona }}ï½œä½ç›¸: {{ diff.source_phase }}</p>
  <p class="text-xs text-blue-600">æ„å‘³åœ§: {{ semanticScale(diff.semantic_priority) }}</p>

  <!-- å¿œç­”äººæ ¼ãƒãƒƒã‚¸ -->
  <div class="flex space-x-2 mt-2" v-if="getResponses(diff.diff_id).length">
    <span class="text-xs text-gray-700">å¿œç­”:</span>
    <span v-for="res in getResponses(diff.diff_id)" :key="res.response_id" class="text-xs px-2 py-1 rounded bg-indigo-100 cursor-pointer" @click="openResponseModal(res)">{{ res.persona }}</span>
  </div>

  <!-- è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒœã‚¿ãƒ³ -->
  <button @click="openModal(diff)" class="mt-2 text-xs text-blue-600 underline">å·®åˆ†è©³ç´°</button>
</div>

<!-- å·®åˆ†è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div v-if="showModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
  <div class="bg-white p-6 rounded max-w-xl w-full">
    <h2 class="text-lg font-bold mb-2">å·®åˆ†è©³ç´°: {{ selectedDiff.diff_id }}</h2>
    <pre class="text-xs overflow-auto max-h-64">{{ selectedDiff }}</pre>
    <button @click="closeModal" class="mt-2 text-xs text-red-500">é–‰ã˜ã‚‹</button>
  </div>
</div>

<!-- å¿œç­”ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div v-if="showResponseModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
  <div class="bg-white p-6 rounded max-w-xl w-full">
    <h2 class="text-lg font-bold mb-2">å¿œç­”ãƒ­ã‚°: {{ selectedResponse.response_id }}</h2>
    <p class="text-xs text-gray-700 mb-1">äººæ ¼: {{ selectedResponse.persona }} ï½œ æ™‚é–“: {{ selectedResponse.timestamp }}</p>
    <p class="text-xs text-blue-500">semantic_alignment_score: {{ selectedResponse.semantic_alignment_score }}</p>
    <pre class="text-xs overflow-auto max-h-64 mt-2">{{ selectedResponse }}</pre>
    <button @click="closeResponseModal" class="mt-2 text-xs text-red-500">é–‰ã˜ã‚‹</button>
  </div>
</div>

  </div>  <script>
    new Vue({
      el: '#app',
      data: {
        diffs: [],
        responses: [],
        search: '',
        showModal: false,
        showResponseModal: false,
        selectedDiff: null,
        selectedResponse: null,
        historyMode: 'diff'
      },
      computed: {
        filteredDiffs() {
          return this.diffs.filter(d => {
            return this.historyMode === 'diff' || this.getResponses(d.diff_id).length;
          });
        }
      },
      methods: {
        openModal(diff) {
          this.selectedDiff = diff;
          this.showModal = true;
        },
        closeModal() {
          this.showModal = false;
        },
        openResponseModal(res) {
          this.selectedResponse = res;
          this.showResponseModal = true;
        },
        closeResponseModal() {
          this.showResponseModal = false;
        },
        getResponses(diffId) {
          return this.responses.filter(r => r.diff_id === diffId);
        },
        semanticScale(priority) {
          if (priority >= 0.9) return 'ğŸ”µé«˜åœ§';
          if (priority >= 0.75) return 'ğŸŸ¡ä¸­åœ§';
          return 'âšªï¸ä½åœ§';
        }
      },
      mounted() {
        fetch('https://raw.githubusercontent.com/ki72yu/thought-log/main/soul/diff/diff-log.json')
          .then(res => res.json()).then(data => { this.diffs = data });
        fetch('https://raw.githubusercontent.com/ki72yu/thought-log/main/soul/sync/persona-sync-response-log.json')
          .then(res => res.json()).then(data => { this.responses = data });
      }
    });
  </script></body>
</html>
